<div class="dashboard-layout">
  <!-- Debug indicator - remove after confirming it's working -->
  <div style="position: fixed; top: 10px; right: 10px; background: #5865f2; color: white; padding: 12px 20px; z-index: 99999; font-size: 14px; font-weight: 700; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); border: 2px solid white;">
    ✅ NEW DASHBOARD v2.0 ACTIVE
  </div>
  
  <button 
    class="mobile-menu-toggle"
    (click)="toggleMobileMenu()"
    [attr.aria-label]="mobileMenuOpen ? 'Close menu' : 'Open menu'"
    type="button">
    {{ mobileMenuOpen ? '✕' : '☰' }}
  </button>

  <div class="mobile-overlay" 
       *ngIf="mobileMenuOpen"
       (click)="toggleMobileMenu()">
  </div>

  <app-server-sidebar
    [class.mobile-open]="mobileMenuOpen"
    [servers]="servers"
    [selectedServerId]="selectedServerId"
    [mobileOpen]="mobileMenuOpen"
    (serverSelected)="onServerSelected($event)">
  </app-server-sidebar>

  <app-channel-sidebar
    [class.mobile-open]="channelSidebarOpen || mobileMenuOpen"
    [channels]="channels"
    [selectedChannelId]="selectedChannelId"
    [serverName]="selectedServer?.name || ''"
    [currentUser]="currentUser"
    [mobileOpen]="channelSidebarOpen || mobileMenuOpen"
    (channelSelected)="onChannelSelected($event)">
  </app-channel-sidebar>

  <div class="main-content">
    <div class="content-wrapper">
      <div *ngIf="loading" class="loading-indicator">
        Loading...
      </div>
      
      <div *ngIf="error" class="error-message">
        {{ error }}
      </div>

          <app-chat-area
            *ngIf="selectedChannel && selectedChannel.type === 0 && !loading && !error"
            [messages]="messages"
            [channelName]="selectedChannel.name || 'general'"
            [channelType]="0"
            [channelId]="selectedChannelId"
            (toggleChannelSidebar)="toggleChannelSidebar()"
            (toggleMemberList)="toggleMemberList()"
            (messageSent)="onMessageSent($event)">
          </app-chat-area>

      <app-voice-chat
        *ngIf="selectedChannel && selectedChannel.type === 2 && !loading && !error"
        [participants]="voiceParticipants"
        [channelName]="selectedChannel.name || 'Voice Channel'"
        [channelId]="selectedChannelId"
        [useService]="true">
      </app-voice-chat>
    </div>
  </div>

  <app-member-list
    [class.mobile-open]="memberListOpen"
    [members]="members"
    [mobileOpen]="memberListOpen">
  </app-member-list>
</div>
